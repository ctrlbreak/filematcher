---
phase: 18-formatter-extensions
plan: 02
type: execute
wave: 2
depends_on: ["18-01"]
files_modified:
  - tests/test_formatters.py
autonomous: true

must_haves:
  truths:
    - "Tests verify format_group_prompt returns correct string structure"
    - "Tests verify format_confirmation_status outputs correct symbols"
    - "Tests verify JsonActionFormatter methods are no-ops"
  artifacts:
    - path: "tests/test_formatters.py"
      provides: "Unit tests for new formatter methods"
      min_lines: 60
  key_links:
    - from: "tests/test_formatters.py"
      to: "filematcher/formatters.py"
      via: "import and instantiation"
      pattern: "from filematcher.formatters import"
---

<objective>
Add unit tests for the three new formatter methods: format_group_prompt(), format_confirmation_status(), and format_remaining_count().

Purpose: Verify new formatter methods work correctly and establish regression protection for Phase 19's integration.
Output: New test file tests/test_formatters.py with comprehensive coverage of the interactive prompt methods.
</objective>

<execution_context>
@/Users/patrick/.claude/get-shit-done/workflows/execute-plan.md
@/Users/patrick/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/18-formatter-extensions/18-CONTEXT.md
@.planning/phases/18-formatter-extensions/18-RESEARCH.md
@.planning/phases/18-formatter-extensions/18-01-SUMMARY.md

@filematcher/formatters.py
@filematcher/colors.py
@tests/test_color_output.py (for testing patterns)
@tests/test_json_output.py (for formatter instantiation patterns)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create test_formatters.py with prompt method tests</name>
  <files>tests/test_formatters.py</files>
  <action>
Create a new test file `tests/test_formatters.py` following the existing test patterns (see test_color_output.py, test_json_output.py for reference).

Include these test cases:

**TextActionFormatter tests:**
1. `test_format_group_prompt_includes_progress` - Verify prompt contains `[index/total]` format
2. `test_format_group_prompt_includes_verb_delete` - Verify "Delete duplicate?" for delete action
3. `test_format_group_prompt_includes_verb_hardlink` - Verify "Create hardlink?" for hardlink action
4. `test_format_group_prompt_includes_verb_symlink` - Verify "Create symlink?" for symlink action
5. `test_format_group_prompt_includes_options` - Verify prompt contains `[y/n/a/q]`
6. `test_format_group_prompt_unknown_action` - Verify fallback "Process X?" for unknown action
7. `test_format_confirmation_status_confirmed` - Verify checkmark symbol output (U+2713)
8. `test_format_confirmation_status_skipped` - Verify X symbol output (U+2717)
9. `test_format_remaining_count_output` - Verify "Processing N remaining groups..." message

**JsonActionFormatter tests:**
10. `test_json_format_group_prompt_returns_empty` - Verify returns empty string
11. `test_json_format_confirmation_status_noop` - Verify does nothing (no output)
12. `test_json_format_remaining_count_noop` - Verify does nothing (no output)

Use `ColorConfig(mode=ColorMode.NEVER)` for TextActionFormatter tests to get predictable output without ANSI codes.

For methods that print, capture stdout using `io.StringIO` and `contextlib.redirect_stdout`.

Test file structure:
```python
"""Tests for formatters module interactive prompt methods."""

import io
import sys
import unittest
from contextlib import redirect_stdout

from filematcher.formatters import TextActionFormatter, JsonActionFormatter
from filematcher.colors import ColorConfig, ColorMode


class TestTextActionFormatterPrompts(unittest.TestCase):
    """Tests for TextActionFormatter interactive prompt methods."""

    def setUp(self):
        self.cc = ColorConfig(mode=ColorMode.NEVER)
        self.formatter = TextActionFormatter(
            verbose=False,
            preview_mode=False,
            action="delete",
            color_config=self.cc
        )

    # Test methods here...


class TestJsonActionFormatterPrompts(unittest.TestCase):
    """Tests for JsonActionFormatter interactive prompt methods (no-ops)."""

    def setUp(self):
        self.formatter = JsonActionFormatter(
            verbose=False,
            preview_mode=False,
            action="delete"
        )

    # Test methods here...


if __name__ == "__main__":
    unittest.main()
```
  </action>
  <verify>
```bash
# Run new tests
python3 -m tests.test_formatters

# Verify test count (should be 12 tests)
python3 -m tests.test_formatters 2>&1 | grep -E "^(OK|Ran)"
```
  </verify>
  <done>
- tests/test_formatters.py exists with 12+ test methods
- TestTextActionFormatterPrompts class tests all 3 methods
- TestJsonActionFormatterPrompts class tests all 3 no-op methods
- All tests pass
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify full test suite passes</name>
  <files>tests/test_formatters.py</files>
  <action>
Run the full test suite to ensure:
1. New tests are discovered and run
2. No regressions in existing tests
3. Total test count increased (was 241, should be 253+ now)

If any tests fail, fix them before proceeding.
  </action>
  <verify>
```bash
python3 run_tests.py 2>&1 | tail -20
```
Should show all tests passing and increased count.
  </verify>
  <done>
- Full test suite passes (run_tests.py exits with 0)
- Test count increased from 241 to 253+
- No regressions in existing functionality
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

```bash
# Run just the new formatter tests
python3 -m tests.test_formatters -v

# Run full suite
python3 run_tests.py

# Verify test file exists and has expected structure
grep -c "def test_" tests/test_formatters.py
```
</verification>

<success_criteria>
1. tests/test_formatters.py exists with comprehensive tests
2. Tests cover all 3 new methods in TextActionFormatter
3. Tests cover all 3 no-op methods in JsonActionFormatter
4. All 12+ new tests pass
5. Full test suite passes (241 + 12 = 253+ tests)
6. Test patterns match existing codebase conventions
</success_criteria>

<output>
After completion, create `.planning/phases/18-formatter-extensions/18-02-SUMMARY.md`
</output>
